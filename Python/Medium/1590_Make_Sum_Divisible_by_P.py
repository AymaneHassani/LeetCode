"""
Date: October 3, 2024
Given an array of positive integers nums, remove the smallest subarray (possibly empty) such that the sum of the remaining elements is divisible by p. It is not allowed to remove the whole array.

Return the length of the smallest subarray that you need to remove, or -1 if it's impossible.

A subarray is defined as a contiguous block of elements in the array.

 

Example 1:

Input: nums = [3,1,4,2], p = 6
Output: 1
Explanation: The sum of the elements in nums is 10, which is not divisible by 6. We can remove the subarray [4], and the sum of the remaining elements is 6, which is divisible by 6.
Example 2:

Input: nums = [6,3,5,2], p = 9
Output: 2
Explanation: We cannot remove a single element to get a sum divisible by 9. The best way is to remove the subarray [5,2], leaving us with [6,3] with sum 9.
Example 3:

Input: nums = [1,2,3], p = 3
Output: 0
Explanation: Here the sum is 6. which is already divisible by 3. Thus we do not need to remove anything.
 

Constraints:

1 <= nums.length <= 105
1 <= nums[i] <= 109
1 <= p <= 109
"""

from typing import List

class Solution:
    def slow_minSubarray(self, nums: List[int], p: int) -> int:
        """
        Given an array of integers, we need to remove the smallest subarray such that the sum of the remaining elements is divisible by p.
        the solution brute force the search for the smallest subarray that can be removed to make the sum of the remaining elements divisible by p.
        """
        n = len(nums)
        total_sum = sum(nums) # Total sum of the array
        target = total_sum % p  # target remainder
        
        # If the total sum is already divisible by p, no need to remove any subarray
        if target == 0:
            return 0
        
        minLen = n  # Initialize to the length of the array (worst case)
        
        # Iterate through all possible subarrays
        for start in range(n):
            subSum = 0
            for end in range(start, n):
                subSum += nums[end]
                # Check if the subarray sum modulo p matches the target remainder
                if subSum % p == target:
                    minLen = min(minLen, end - start + 1)
        
        # Check if a valid subarray was found
        return -1 if minLen == n and total_sum % p != 0 else minLen
    
# Time Complexity: This solution has a quadratic time complexity O(nÂ²) 

#==> once using some big arrays the above solution was met with a ETL (execcire time limit) error

class Solution:
    def minSubarray(self, nums: List[int], p: int) -> int:
        n = len(nums)
        total_sum = sum(nums)
        target = total_sum % p
        
        # If the total sum is already divisible by p, return 0 (no subarray needed)
        if target == 0:
            return 0
        
        minLen = n  # Initialize to the length of the array (worst case)
        hash_table = {0: -1}  # To handle cases from the start
        prefix_sum = 0
        
        for i in range(n):
            prefix_sum += nums[i]
            current_mod = prefix_sum % p
            needed_mod = (current_mod - target + p) % p
            
            # Check if we've seen the needed remainder before
            if needed_mod in hash_table:
                minLen = min(minLen, i - hash_table[needed_mod])
            
            # Store the current remainder in the hashmap
            hash_table[current_mod] = i
        
        # Return the minimum length found, or -1 if no valid subarray was found
        return -1 if minLen == n else minLen
      
### Unit Testing

if __name__ == "__main__":
    assert Solution().minSubarray([3,1,4,2], 6) == 1
    assert Solution().minSubarray([6,3,5,2], 9) == 2
    assert Solution().minSubarray([1,2,3], 3) == 0
    assert Solution().minSubarray([537219148,853740832,953953260,489897687,635137667,461724091,983953727,646311025,900328174,830779490,840052572,238856446,249641356,264213715,212519950,665286932,162324041,898934295,107776125,834444987,278416288,11404763,251346916,735522200,535888038,74162225,566795343,17245100,697832763,650478806,163306501,381482449,26947038,442691544,376837063,122015476,819229389,795255846,277656591,704159055,952601902,372158979,391326289,684275859,829940483,321547417,303507816,477385725,427545808,549782156,671676134,561272294,333446239,423626909,100458593,319495546,232279602,588223524,967134730,288421942,166717388,359535529,436116845,290616628,930541815,662849649,944914273,230492785,259566641,249450811,236219660,559647542,574118846,90851526,66940655,640061424,193922904,572197515,696695479,15796456,563014136,583645207,427824385,732951708,690582437,651974930,748427990,967225246,456852679,355039215,992162614,471176991,157532849,724434329,409888681,239009317,558761873,731535955,346360188,511822801,170993768,200204906,557251330,420934502,58909217,937863715,466622225,345644000,314552266,296182401,296668383,495892613,882504933,745671061,660556569,680884441,862149093,637290603,636668459,750339372,558394440,379407447,756492818,932843362,586459764,879605257,140958472,159988516,97794276,694057164,936959637,443674333,949271664,617996628,914176892,451110969,186553379,605969893,339471173,468192356,536085280,736662454,689149540,966494409,487497466,820296950,987405252,881888242,692221509,953149524,829594575,453914798,800401069,454933367,548468481,374611295,725901930,261004243,785269152,780457478,70000415,658224765,10253571,965811577,973681192,638634493,49358026,502108956,790429083,824230139,395892817,71226707,579700491,205919979,226620724,754374243,210910738,847426812,693532761,456841841,646400856,749702933,333354552,903605533,181082787,30193999,364885818,885113916,79181731,374818248,471109981,836532448,152872491,868966988,136353326,94141922,197503468,328927534,751656971,940408053,615121882,365262545,139369309,965331160,185605029,242083713,337399455,71144234,722841392,322733403,926229635,267682013,408386775,495676193,9635436,810162342,143678825,46682390,92725662,936397487,46658693,521395592,771466797,976932091,675561264,164860434,478982556,863274844,108130744,873192254,180357712,105768522,305398209,346590384,245094285,805621429,498516010,911161641,547301100,507870815,729300359,51283236,226435722,450720497,227059480,80497407,511526296,605062027,919529055,909858795,559471442,772764176,91763549,899962328,947001928,786210810,743144333,547671442,977126283,126745409,50871028,355450231,996364261,10814936,243750224,738519559,694820867,965512620,276940339,975269382,538553655,298212419,410700711,160478867,977900676,529299997,725087783,732693847,882189370,977936271,722361275,484387935,438456854,904421979,876405060,998092933,510470361,618599678,692549897,513049752,152246217,305359371,799406183,935175333,552591186,475521995,452082776,411376112,946747608,570797272,71376673,378815257,292888357,219441485,300755263,118544864,528999172,892667319,686451064,428464301,324928433,797469319,279976089,872019857,929444560,973491587,130593201,959442154,545113995,548776492,88636187,482321620,437207427,971653783,804628509,558069898,340273904,474944608,383596726,800928036,145617050,991978597,61666906,223023957,783688579,126617141,645802344,676557793,328728390,168365381,954916548,227551890,602106385,4188383,793965906,780755139,23085236,660498312,100180158,613480140,473013564,864451808,975754050,430646540,719658300,736446865,89614960,573450657,806075218,269018708,922419013,454347140,11756956,87756906,291052090,91394069,756838530,869656927,473145541,906479147,976900399,978338773,843475352,906216778,782828657,434688589,321671293,639127769,305475457,81555133,246709174,918512028,596544654,224502398,297823540,975534309,200515637,979494138,946369784,587483653,459810660,471056083,733935725,881086565,927828034,299403146,607593777,523874752,172688494,621931522,17925609,835375031,679517634,474482172,705892365,53564838,536883185,12926911,437166066,846587010,612628231,590797550,715754846,103050305,598322387,227890398,460460603,431340707,274787181,36811223,633502579,705673243,791117081,124553094,559509386,729316506,787405507,710102011,967829363,568717446,1822642,488003399,178480957,464707484,928456778,485076731,194047247,968854969,173721869,713265518,947189452,339193198,569915365,564920498,667333309,203344374,480365223,756346057,789292938,251632234,522936169,532457467,448113609,819660091,873791320,378863040,906739601,276330118,667733242,355358609,220845155,171011304,212413996,1731960,598482154,911458636,593484628,396534191,445752370,682760623,524644916,857588637,802389147,31870498,654996368,339377146,39512441,662929158,942506026,829668446,664176385,751931774,722663768,81769024,668014791,222749107,5470228,28434350,165355731,951226310,538838953,158122544,225955784,37102445,812822219,519074500,144866309,568314737,633664507,997017056,871800438,30337175,366776393,739042590,319626978,721842508,746597999,716296945,296624302,838657681,861569606,878929940,221080208,424333446,464380301,172283196,778047932,936152238,729837387,761827996,803791335,160627801,126345626,261289251,895508751,918941471,317368545,792201844,742971318,635894734,257084367,553900812,394625615,755860122,833410555,198746871,88126591,992931136,93539398,209425675,684897741,856812459,625070371,522133903,546376987,692064717,796785527,30317843,729662006,649447592,786518200,934172984,559538340,554035634,593032234,539229317,410503106,342022768,475285487,563164001,112091036,305744825,978589017,269280831,209317567,561953514,74614963,286353405,11109800,76206867,878042939,6601309,244651699,39274262,721188576,958810462,497063698,206247321,956256683,696097975,690733888,962979493,985527812,652893227,299825975,89356631,492157950,475856615,901876134,27596814,181714815,781005929,134192059,96821960,936043571,656530348,604084577,972823870,649012200,688312835,18144616,506503597,318574406,503672560,529331945,449268708,654846979,194140814,597574833,351047208,91633630,624942183,688070084,779381972,999873993,168019961,317981949,235644042,101328670,902575422,665296077,742926364,532496274,68477754,685401357,72008465,685497086,909882526,824922305,456460635,632360769,120669055,50991837,616970605,427377291,460596252,39567824,128132218,228058914,586579177,838976893,892552064,925772322,178113053,517393962,289378954,843195360,607746385,706184934,967527385,46047600,831411773,24353379,67690282,15758619,188357414,611134741,718237559,770107793,424890833,460553299,4381181,2506129,617842179,302924672,302617700,582901615,733978767,959796189,574070779,173594299,463888258,667906919,706047032,299752603,855659258,946882251,582192728,893232909,19246055,519301582,715520853,546480814,628224086,98955468,903664831,968116782,48896934,83196853,540991085,999819788,560109516,332692189,454260176,981523958,480971123,277157802,76214114,625592144,801125496,399438814,992486063,428016128,625621731,104673020,548169968,126021278,407304015,731468199,390449445,223957540,964002579,50229034,935929321,223763173,373445877,684877413,642295916,794236110,767640847,921692318,295084365,950723645,640912570,116791507,145378616,10740670,41206287,667488300,58004113,168785763,277563143,399130714,594101194,968157263,604401038,956040144,953430384,690605365,499389724,323736678,350253923,216683404,798181449,458463132,969739862,913953634,263831549,810392,498352651,57051795,557074182,46826042,681409406,970549487,836370734,99635495,829410495,260224952,523454456,862770413,342996175,991032236,377748799,730776256,203545690,488678837,298638326,984107398,984798117,332630917,286350562,465240225,934558855,188950036,954978345,432525867,980295723,986492741,301684381,828633260,983214886,40994718,647559804,10064743,356405046,35279735,330480611,169403265,328024500,968689381,198197105,428681461,922899366,685464280,200878942,49744332,499715061,269437981,944529409,651581866,770543187,181684530,320624944,925744067,60608722,721448158,521705506,102924844,395754846,856931788,688513029,153303778,385110099,212569289,358864653,146803793,110684464,969973601,657759798,981672398,489386367,512779216,310763542,875837944,303047501,788207186,762804076,40528934,422559166,292495673,860046961,249271391,591412641,785350113,600393794,246848622,547698126,579976771,251983531,223227343,445652929,544870857,200732845,44837316,225619153,645670355,53449677,195045511,55986050,780106906,66238009,309470979,184112907,282440684,380388827,317700209,756308232,825274548,386310534,11888927,759529504,82674068,400770978,837514570,805292111,250949529,134726686,103950406,256805708,963253753,177802005,99233491,936647534,986341517,155711691,151828457,332646864,289978782,558611758,296108174,446329450,914882960,626960689,461937810,250498036,162214920,387152852,885284913,125955656,33098353,675640715,713079919,87746867,772616856,603498614,315001918,344952097,510874613,412831873,271751948,614934170,823403069,170752419,265501628,333067752,761625407,897652923,245575488,373414020,875465577,229739845,526342083,640626928,37792202,318502466,789315396,204640615,132361775,543066947,511191950,162023374,392984048,498585961,741554242,465323210,890284602,739249376,913418508,193871735,719378382,513897812,112110942,299275672,365605867,45173543,276083100,104672338,448992393,252318551,763015986,65000468,453121905,360190325,352586630,373566255,917842118,92480294,327652476,176683888,876489927,322462334,876715990,325139267,806268628,14106394,677937700,343847371,937321088,925823927,813246993,587583021,642378576,268291236,28492550,514754310,641597861,210604574,100166230,655589643,350421313,389653052,209024007,125146976,903818424,715574718,659262141,224851734,790159605,188398900,654853979,244886177,967681257,952763851,425769196,133245006,821263324,865041748,389664866,729603356,964784849,985130525,548516661,461104476,244308273,291486428,341728319,615339261,401952874,789172540,173345719,884977824,912185934,537280911,376624119,381993530,197672650,246166578,280191134,291945012,143171956,430459635,412956267,979713115,634752617,306789831,52654594,761675435,951876762,252149708,863069356,665837563,527022883,67010017,661673467,122194440,625813289,857502317,948976056,335693477,227560418,442429093,409485338,916098699,675045635,632753642,288026520,597754230,358344597,541125058,921671194,538980105,277133638,695102298,947064399,121650818,700695837,217110064,495901569,458501916,150978683,729267755,997886595,14669309,73780491,599868318,4272717,341425620,191027541,641992740,792837839,371191969,640610014,359913721,901532,490018390,324845600,167384997,814175827,99450727,207309427,998742795,955976985,423859144,505971796,601655535,418185698,15709348,789936592,44829058,722744681,122238659,320128532,94238352,717429208,649586625,530944389,987513818,647501110,625454882,532921241,367492626,210744538,714374442,340242236,375577493,425492172,719736663,172452989,67488014,897010352,634504716,660855983,87838258,974859134,115146738,697616752,843469877,484067147,855741294,375697042,828793351,666231301,362927602,570296557,545575427,391375235,479326685,812639397,502891245,353648401,38995084,958559754,929813055,569546701,801682712,726567162,747257759,963052720,868172905,535238701,162648583,632647092,204905771,41114620,114127505,994652739,507143511,642972374,318107554,737298794,267311230,670119638,254220417,521577646,574987179,436401165,382893190,904048703,643606288,81564700,235210874,118731258,521538355,632728001,447863959,309116977,39858501,989251625,195138225,535704487,863961473,585692833,718767723,155873735,158530280,163858739,179993882,572315371,44080189,509992009,450787310,307663962,132825233,50699555,711178443,941529651,191281654,313801624,713057437,540019698,880477148,525098297,340047087,206754592,936835113,327392448,762407872,539348307,199617560,949832582,611924756,185567772,703190002,123522943,348824012,540456209,758326388,62808307,646603232,606523801,814122309,947580138,233688089,37456101,231437869,105423744,997404999,723967870,752010009,683878843,647932478,71669544,683993636,659684116,485179450,280239270,822633954,881314448,78290626,231520600,37779557,770387444,22494813,158392980,941724729,45865938,563568093,236948023,697847932,875755057,641166082,226574795,175826985,749388925,613618659,685763763,321542792,409446536,461443639,750751720,285827095,589353751,34273729,561307663,278683784,937428554,223089415,196389636,642407641,791376009,722879703,661589665,2496411,831395249,247741051,805425267,268609221,4099334,10094623,239500236,463196140,600969263,837103771,850933481,478326081,652722699,423038349,458253674,367057170,263223847,170703814,630135066,700173487,872843171,945453400,95199295,797012497,882790183,231992144,792960112,294188487,66495545,764860970,820613219,191775140,427252735,728501984,668324062,16706397,432243908,512875615,240721873,845720606,494285816,815608752,554391396,785036244,297764134,881230837,321410632,633204243,768170445,636390701,75658410,99659379,938246765,632499357,342978982,744397686,120292830,603864666,993336398,500701891,559464617,102881590,725350155,704849244,737756925,85438753,999095440,648432597,924662101,382409667,555626587,89079622,151903605,344739064,775841499,173198436,162186671,955949159,595806535,913664918,868847544,144926793,264234710,65087580,280671081,922918084,787270163,660729982,159051651,891564927,473325044,519767149,422678017,926761554,187281065,688179773,741344964,304721865,515130878,870056623,654388890,957149151,251548294,750151675,630574138,478372191,460869808,526145273,261136950,831740811,71168859,304543721,584682285,300512221,318928311,285351507,188934940,844854018,394673130,195565153,642703224,273341071,673711332,23182124,48324317,997738793,240972193,471967449,486238314,787374095,906161141,774433744,952637603,540628366,996891073,344022818,500143378,774007733,174626261,878857957,431857538,625364779,408015226,691487716,381904488,36952607,26807424,609535096,890177797,872976254,611307595,43087554,90483843,855823510,400974234,490867287,598487734,488543392,918060917,110906125,481433408,639116573,979258781,526893646,764268753,387518355,650595968,261737337,104139459,291930110,377783846,921022293,306136361,802503386,840488210,7587682,779950660,850788356,185712114,889184725,619098991,872883869,116895371,956246722,791725599,753094683,699092759,181276051,40650635,112047499,993264608,467115566,970754289,492467867,320242032,547930711,916335520,487545197,390624330,182749821,110171403,404321328,446649232,174954569,739883948,645847585,207437988,732023826,321204465,354448365,524199562,82177244,568991068,219214314,58089884,99034293,952563164,713867627,686519368,452181549,993777252,467489067,11063872,283822739,317183296,382316491,26223776,739726094,490852015,850173863,814772192,274670702,713014323,292551053,913282812,994434748,889740131,135755476,680087223,380727162,370467941,6829101,162075569,252733373,822039409,843439065,462264490,75156539,584958208,511489486,631983990,720830080,44279406,817760179,288287983,312417478,550899090,306160278,237882942,205701807,905103275,546726258,516889020,439627888,625703140,952041092,335108003,621791987,127855142,583944873,988669510,872014147,112538439,455552263,86306918,172412990,77409814,696414361,391709259,311691345,907902735,776192688,357456822,50417871,598842156,147094496,961707912,449759753,154976946,618599084,829943174,999323852,289751649,189813138,923388476,888182921,903965534,883360875,685910029,177540260,967769450,893665243,9284121,870496934,653382638,766854111,817099219,277587239,359789482,42641882,731838114,718481753,476507190,41898838,413875267,18967993,465406250,334721085,935065337,781611570,866437921,939548626,217781532,573378883,254815447,140238283,484185702,163299239,91020205,466372824,117969009,881989922,613201985,667758187,53274615,733249309,971175188,92614153,72420636,774008654,762451122,748273054,840378792,507553477,997271480,400699895,157554386,637937545,295576893,602629878,183619602,766006377,728221081,192663977,833056034,498185722,946140073,962171045,772846492,315394962,281306395,681574173,145616158,807383453,909648410,170656511,196081901,757263858,772235393,389579136,94670925,431233212,881056554,392621204,888735800,125623344,168185697,892636607,454574727,956691212,470928948,999537600,935851278,204312448,474995948,526070984,933964980,598061587,536593886,465188889,29438274,487110688,45830401,102692829,739329327,882864461,939417021,231483731,140758874,17449356,730735040,997854067,246518793,738954299,606748875,781284480,921050538,21980780,611473919,339917728,428161019,902952907,674448284,264403779,622782535,828594712,501129268,625502392,653884269,99687796,10866252,482870276,967116734,744435017,624593509,401733071,882298831,932461733,929706924,602424937,760000811,854944416,166280781,237097960,108675193,842766825,337303594,618368651,753740443,735493725,588724305,700816209,403117534,661331767,924056553,140680224,602107236,978498089,537296009,209106343,397351373,596714222,753776960,903860892,781821132,79512367,201994579,358053389,639145529,353288829,496559402,195835862,573721098,163612484,466172544,838443184,341358898,25139154,854150772,570675488,699307570,314729681,164386274,756486833,601803844,890368336,937532702,266871355,876486598,244440010,318011426,92936259,428078505,726633571,608757439,465166222,18852388,718574988,751730935,354719354,900054544,325007904,419006791,809026297,447603756,108403418,295937560,266427564,415900856,200425889,839930588,548908011,734129235,752004014,487184607,73799457,49015952,31297864,368051121,635887524,578395538,183162913,717034618,449425357,54873014,264510706,762083380,965913463,323750061,525991869,182530187,383882401,722924707,250169005,518326568,581521959,94068805,253010331,916343779,411377662,211388390,716328037,563442516,298770250,918401054,495826826,126904378,132083134,41785305,193225552,232143225,474824323,195132733,525644003,396929969,486021657,753214529,579990470,305811894,219626213,169134910,296874992,800527361,132168051,616656565,21708310,403490980,811063194,67634271,613472277,598368573,871219734,494824064,570478294,656769761,41090720,968595950,985224214,189371294,837540069,817583672,112043923,949014502,523192534,515044833,165352773,577842521,75883822,595476004,3752711,511606634,40669566,341310006,906106915,216859248,91589555,495757502,616223333,390366186,352743871,479872579,627115612,585339724,482583071,107289733,896268004,640701827,769964974,852315602,157898472,895853664,412768406,579774442,307413667,304369782,449347132,537050244,709340986,298394801,451531745,152805038,562905730,444702672,620276668,486218264,854266224,117193517,228568300,478900912,231778918,603908864,644749721,524327225,20162309,495359310,425274735,284509096,250570243,211786479,895636858,903328975,989232695,81657088,127563657,179174281,205034526,397095684,46321482,263931585,545648030,842682630,860934154,775831263,370260193,461649081,894783408,187515285,416560481,728507228,337824753,852387026,325697767,220770481,465577159,87078922,467902320,845457423,2875416,774131237,596925423,333170852,962264255,160713981,210695565,566792447,264639238,605079552,3074062,586058111,153783612,596598672,724390127,171303822,181364804,557874812,162711670,799365653,334754590,918488445,807460271,678855065,644049285,327403211,116085624,154928123,385202504,748213647,684991395,392184196,220804641,946887717,593507559,39723179,131860606,471739515,478617591,223117556,434197825,111550232,530215942,636488923,314158472,402498289,366699490,773236452,52331161,882955478,676137473,671380040,804801617,769273104,438760741,619427713,868624329,172473391,100860046,525758376,998239364,588924070,989317977,610079242,8948490,700029161,453768794,461664433,393713662,238665327,112089596,16857648,956983637,265903834,115810279,610044391,956111478,406976714,268485787,39035716,657297078,968952210,547399057,941259642,735606071,606588647,681388435,824288565,549647897,363580336,861721909,794133557,698436623,831882910,676517241,53403969,475136889,930808943,610025717,456109047,59699336,254528350,286057565,726920257,310542223,325980328,692657589,697416823,876974909,415623138,741468650,628011088,1157372,453488696,629302494,36097823,405147220,764649816,550222412,560869174,269139624,957029515,115663565,178685614,693271678,825281707,683729662,430501083,877330699,479082087,292922596,473309546,370159222,482005803,732752971,879019297,849412090,783059280,292390214,808318622,581031982,766663231,406315214,606198216,391113921,747457897,742155503,134186451,994789396,275564465,583487990,314574533,619247021,36133246,123990209,863080660,444729429,648591213,157428628,527590808,690270411,177847434,375782656,344987723,724339872,931413242,466302632,750785872,401200423,702521818,663278896,541898479,628586211,811362217,742972433,29066365,554000442,58942715,585957403,244439256,571644903,414817250,486610409,889432554,783491606,480901558,696595526,850614107,668472597,256474045,117232698,717831350,797374633,650748570,506256581,942394852,748826065,579772411,413428303,149393045,907168310,640720034,776971350,666526970,223551528,401369793,715545747,99028137,999823178,302801066,873524205,563914271,945683893,645510229,839634356,554156437,574831271,191297241,309037128,18435116,435998854,752819681,493697074,631175709,215435375,469255370,508017772,482003695,838055397,394569964,860708809,629603669,517223588,107337516,730193615,980403463,589326515,759767349,243020785,373489887,798927336,655818455,967916168,129693182,200327530,30128609,952354775,727901199,573302532,437740026,160254437,600383659,691484638,175871584,396949005,242638016,175368870,857845404,282860969,484544515,367197584,900983891,450019751,967492864,395690513,346473212,688494178,15577748,581210870,888838393,640645908,364679636,848461837,190938870,231964371,544096144,369687509,244086089,622094988,479064577,32749989,716707760,643281074,336917646,23330696,43053277,557076682,52881230,424945565,481580001,478772853,180331275,379030057,662257620,565659470,408474466,920229618,325869398,981329404,833025353,298453139,376269912,508171128,780295114,516049836,607387941,713269211,531467064,273722005,166317656,35870361,881635284,401229703,977427188,858464352,254956313,648227207,53358080,828928526,160141530,149590899,293833723,555308793,391226061,269780696,618660859,986248689,282389241,843942044,558984633,371009351,248295556,481014515,647697702,463901876,944470522,845274809,888719341,766387261,903883952,753471031,163899545,420670444,370857311,199412155,72650623,185008927,359937066,200514998,288434019,896217073,426549259,690027628,761376307,509213549,852449038,142986135,373444159,473829465,861393863,255262196,345650305,483067320,834358894,648453553,925393748,978434206,936239764,173311526,789850401,448527994,174706668,790461720,657926663,19457763,931382670,721018928,794413344,892013961,746424916,474020159,657544985,853084495,874282909,24070969,315635836,484917840,16605125,73326769,263601887,275892458,714998428,768665881,649651843,91204790,997258640,249023053,568494281,212644785,39321323,356474189,875764943,814275805,503346031,161892730,961689452,368375681,623842994,613455466,551212621,476572015,406161655,705103639,799850429,982709445,604082538,185203849,673998902,288054890,781252670,590458315,403782396,646391368,93134789,401240171,680350872,110976299,776993401,399869066,688780297,441365397,428943118,452266008,254745892,753055142,776220924,143125298,462437811,872053528,467321682,649952363,208506926,904206107,404235152,422162488,403717310,978939554,749832024,981544883,849026096,516432412,887660852,417383446,122068850,359021897,347115288,837843505,767297296,13953786,874257516,671777976,950489396,101794632,175306743,606576849,212440812,681835257,508552636,492302366,88226732,544765836,769989010,139848123,514864084,364587306,530870634,333772907,803037319,400160983,799833629,317945840,190963383,438536571,799103164,329640995,523875799,799356157,390892260,578519116,447869820,700443340,859179431,753724982,145281215,543814918,926518363,91563305,962913987,4490970,472667116,807382576,577609236,544833739,429591392,325385376,72486463,729039697,609857974,367871399,296449097,423352104,487859423,914290266,329726040,649661806,404368242,22405808,438968038,456222259,493894618,645618164,462111937,10193810,27689231,703467913,760658410,558916330,840020943,929108411,899726232,624825360,432297282,890595636,423315427,830407557,306947714,209072177,19743371,204237677,492792856,398512812,402610782,590590986,425364756,229023838,934494611,878512461,538088989,514471969,112920283,681284880,255758463,717941108,779542656,961494038,117892513,438649030,585084854,177151606,949321902,47392887,876165729,374446684,994110592,803230829,197153365,76978539,584344086,92442128,304842903,830808361,211162650,777287223,841871848,96791127,703941729,650411845,644315246,360786820,960123574,214204210,650289887,283306981,159742079,747904084,376163765,445752853,954847346,349238252,153972918,222933397,534199242,834596620,247797788,570740483,121056277,169742079,358209841,51131775,280311050,527013154,118748791,112080166,247515624,210814730,405436892,239041881,813160000,10948558,68264225,200700444,688563648,724025331,522389218,753996387,674703902,927899729,555161931,575558929,563266139,194296968,124532959,671454920,190390857,955968331,675290620,983131980,177456724,563473180,297151011,363455407,878418823,98081858,195267105,292580459,567065003,485722570,793316059,296931281,895071237,82660807,432661001,874968989,805760983,860630208,355233454,475159121,843488241,520390438,278100291,596754389,597046596,130428107,653259937,146707397,795248183,985559206,517098982,277357123,38358498,321760178,687818946,19374936,357791367,37410592,353707290,547928439,276579744,726065564,153489394,946697328,258446541,547067282,660617817,943646088,70270904,383899042,911652178,304527440,34674574,777981262,67300338,785952522,398725057,704800766,909053945,339557813,847592365,856551997,662712647,432785171,652121239,380546013,641228460,437188579,9605695,109877855,241371032,733624579,315784624,403393598,913775356,878969885,224275422,846890101,367145562,458407928,953077938,530220297,742991522,820343894,428636513,570743528,990742982,10343306,960267883,85206935,635302587,562210669,520188754,671878313,754661208,793397016,302950723,716238337,811896196,717116582,826203257,732282149,941344115,624622026,328061812,427515246,451618845,659232805,442433560,488577260,285788809,95585879,990537444,720250985,495553954,892347540,744875496,417800324,293561831,810833790,646509509,768431870,463097288,734188729,267307593,46205703,595883337,423753700,183084995,610393951,503650449,771108029,876797756,442044436,983348958,763546891,304658974,447857983,826213355,728204104,224395581,825406665,80628878,608826739,257051782,168874335,573565994,847660716,272591192,923113419,708774776,649023806,541378710,476639948,421955906,548183203,791738248,990493067,944529572,551373706,455288842,371692590,594745799,714850519,89116109,920261413,163295421,866398459,642129568,994066804,6198556,215337473,92006733,51945310,525542158,71047981,43946705,918801359,141005399,919078519,742959207,742776200,220113517,774371207,930476905,299833927,683993937,803419298,710272920,622984953,273237125,476905443,716550064,201980023,15032335,438151218,941774280,849883333,598582039,626526113,959368743,662486601,61755455,131504132,867077028,495952257,496237923,521303774,695877460,887311897,531918145,67817097,180945447,20885330,209787555,399896437,777096568,96247884,376511246,210201053,477300579,97403759,756186417,254205065,566244022,436368205,357203493,60618863,317486647,449137320,285772538,893654344,845717212,442915250,745946702,305218052,70616390,683811764,257271818,449715212,413646691,352550538,640146520,900238697,840436943,133715683,264577704,223421843,574941407,402028586,695386172,33943381,110164896,737864223,69573368,696397172,886327476,829398220,959808667,458111417,231800079,37294456,522395723,730580913,889148455,246903543,228256362,994887263,815036188,256690568,132376683,906050461,24880838,638362747,212627912,935633235,101939734,909827322,647485342,146492178,443608903,722595340,352912891,80347385,13279829,630990014,724264426,595649308,949757114,452157725,133643703,936353412,349941096,489983643,615519602,362000721,884020889,877073288,1183785,268696149,638082708,916543216,487590567,403254765,861746830,827586734,539507613,502831890,800803545,448085326,114967108,684095028,637754545,634987251,816786127,118538500,74848747,913952869,14278600,757009162,56453180,894352561,500514212,420755105,341813173,457478435,153685117,361468388,852409486,237554926,800905694,419843305,26760035,357289073,269030136,811789887,778407226,736975777,417620501,57934222,638932128,221961002,526815522,487448003,738683160,945748167,605347685,461695680,571861895,30822972,179085638,814569817,801186713,642645053,654737473,697591927,884636198,208691651,222510836,217481445,640129322,210776961,874201629,703477335,210052113,849851166,70585653,25383648,311788722,688620467,868436526,169613130,514059843,504496854,50759046,210123352,262821524,720203978,115526063,887580830,908308853,931546932,935998226,688748139,462186146,92687924,624770799,240598232,290499786,235197258,37574251,212647031,352546400,736254770,814226322,683851352,136258583,795709865,27749927,352738040,38897473,815127860,910974644,842367757,858032215,843286214,933097512,534238862,865127820,957865540,415028967,575631330,415151697,524178941,479606865,22995095,163657478,694967571,589054968,943040427,437360288,218849822,389699758,946758471,790714866,593344495,599627283,130151147,650514097,760225756,454801392,64987571,798650305,101282791,258049101,374296306,161846240,818007722,558153793,722581300,127762429,596784606,202555975,173103096,861470939,141588025,732130164,106799560,276950500,808367562,22532943,668107161,385488178,665041648,988970480,189216399,26672981,438015782,182229905,663845292,453995631,654919754,976047298,950361261,100062938,109328561,975095908,688328084,911408312,675823734,929892805,999048202,572249492,129689723,976205312,609214938,840975756,807238109,398652754,414053605,198844961,121763239,370272910,917893826,422204448,936821224,583109458,499682857,282140505,952337260,634899452,302123435,377098923,24566936,45547518,702604116,610960395,138521195,474038456,198300256,471086434,988595712,507263758,962363259,123294220,970479068,161210313,869139122,669090450,974176263,922989384,570201354,867892592,124758542,844987663,114738094,212925872,659184478,643507297,407353089,885243891,567413428,694294716,140287084,435082502,519845525,244490089,929167536,426201105,116322981,283587297,156749559,287310776,890566872,437407519,118294277,338126826,397907134,474116637,759522909,937348535,369189783,482171473,715171974,454798831,246259036,511725803,489264548,590826318,586917993,718723899,484452928,958675068,775581335,70072924,925041861,212475017,350781715,612429877,946549151,442280395,881004186,542176064,24963481,100499103,510756326,940264174,621122619,728749573,889450086,14118,41994093,211560999,654959031,84537701,89952379,432220652,909728646,601588652,721902783,171939733,892514564,606416407,435973596,595360550,924839477,818870790,876762210,411751286,799927886,215278154,853525676,782802536,632201847,558703537,233374109,363656000,352905437,543090007,772104316,35442027,307098413,915351367,589091846,136192657,505142095,499357410,558503186,12097694,328539358,420146047,312491303,567430131,929955270,127273232,542993358,192182574,748581431,921085943,785767480,645155690,542946468,315302848,89243436,27807765,967768903,613021859,506469500,74001187,822786266,743056249,936547270,974922842,860685648,899501890,566245882,972852834,937066635,563042233,924496944,73209266,774106931,56962873,19276799,887975226,663938821,86862675,292610310,679974711,543030262,424053171,757295815,243089518,788764838,308646706,702009374,460592633,150439384,24028018,933734216,301961750,621847103,960108447,752875591,895923366,972262243,341520371,29581460,654138169,212350016,814496296,61101375,669706208,347894721,519050312,325779199,861216473,643006027,263719940,827246743,278613803,340971160,422875319,529193263,847047570,748101959,92742231,791211705,640463561,356395017,423050031,786740060,230888355,818628641,537870507,153634360,34017176,318765102,794274679,271742907,724987200,497755128,955629399,24445876,492929654,935915510,957282033,616456864,21077362,101828379,396467921,787006835,205624745,105571681,922261272,646738110,99710312,784881890,842106005,442943328,759285879,429773473,478746948,117467859,490985804,42799757,517166900,990208128,244784683,194068005,206622256,922049580,740822108,976954414,59814491,296018258,339793553,907530995,985466087,536097668,652197205,26733909,366596231,930640952,864652705,373324873,640097407,185871693,621428506,943027911,442886916,769795209,967627946,898172070,811928623,330017434,27716183,290742850,379103053,491247771,156640255,502509815,222540454,507773020,241762554,818293173,414076675,748082128,665336777,34635517,416962555,454201320,453827945,802328794,256432473,435269130,927887056,919421344,740505593,554812080,292497381,916971473,656790268,439981410,262771447,91045104,685964344,708422391,780139714,234719198,128770573,830792185,717751326,717515346,494822451,880290728,605346966,895151394,813562553,17712624,18006905,715598095,298530836,887732679,862592289,485646179,307930043,14078981,235517518,481545294,812185540,241305106,93741056,507897409,435795631,156662325,841537275,538507665,562376821,50739920,893272567,134234199,607479630,626103045,581944777,762942796,30423974,942699533,302263389,982458696,636863309,137169805,448582101,227500400,475632761,763273115,167056429,190210763,123484348,637007349,553160112,740504426,239510840,550554568,322578093,457334568,204980238,744658073,194603336,833580136,121397859,419473482,802286103,557635432,866566998,392246083,627610807,411388600,379487454,317167689,860903803,934975233,36149720,38073985,390786872,845093279,138577758,439806357,350494402,419491386,627497991,778084193,694553279,252001843,738555561,430888686,493443237,867071380,60161663,283690903,205935774,862511594,538320081,6236926,940437182,694653414,524418223,720116616,34458290,32063612,51081054,1638213,3028691,917391167,838078731,947445132,118362140,716337805,896634516,603184160,93785848,538501230,430457693,979078178,648831177,403068358,581262794,655716889,187507756,393490530,543085448,851575710,318457045,270877290,452820325,355306045,101216191,606047197,575040802,266637361,633644788,211445571,979330581,845349397,735426495,294448572,458628482,231992233,896221522,435607088,159038795,938421782,404492774,751260187,587742708,57547996,849458797,677749358,4788041,300603165,889251028,85146334,871937425,598207719,80662327,316781390,65972919,790782031,997964922,707431288,42961838,174463572,134951927,888481239,829288744,356421635,106230408,316287651,304511107,95273946,75236633,434255802,786449764,907830408,384681267,321961379,56519094,930356103,885672744,602729675,888960055,874717987,23506158,156644519,327415794,979726439,731403677,559496156,703326316,631229765,516262158,595565245,55983439,555361215,353863717,983076179,607547960,418010254,85268893,840646305,123517800,763628647,481897687,898833648,147259378,850975176,389311552,254576134,316483849,885902485,428569417,778686029,733643483,164216160,522811361,611353039,935889662,924378425,724955385,23216574,294570016,647629982,91717736,842629843,930713590,585777260,316902232,207551230,107313622,132114466,463213094,678851098,662171041,570086352,157972779,335281037,567084566,991521477,697172599,571597287,382796432,863372691,292330229,851774698,719152909,315672705,4989975,178659964,670398017,386030228,125294915,130303956,733312319,416665024,278877686,424858531,486487438,69760167,94779310,909874796,412349135,898456974,720021717,298321172,129974804,627225986,443605121,662622476,667529748,424065820,912324281,872303627,530095231,916029412,722361483,866575412,4795229,561343563,996778338,558999303,38736165,996019460,858300548,457708215,399316411,79749612,989540317,541613972,259242463,5997981,632729761,896307267,159499524,698403143,651030174,836727327,266574727,351057871,288834632,134519865,827201978,739621042,429782364,396237457,966661609,605944543,436891180,814412746,763160187,353144143,708279469,850420205,278087625,375971733,913493499,849602955,36681193,149913158,429693834,282015631,204028092,628519856,327735248,612346694,669398574,232448274,752656593,959729365,228168775,141385728,291260411,167918466,548449088,329098737,28963250,119100563,5744493,885961310,311576880,137680694,782217825,15992046,579235198,388860438,296818269,742213000,472433644,724760007,731091295,254761450,760481274,933752841,464595771,232573624,128129616,969421559,713721501,41670959,871523531,701987710,662962184,850123452,797915568,696444851,995548597,359514052,556353691,780577986,806114395,59188114,657333235,69880729,89530678,570542639,452938971,131590347,599952741,959273360,615582174,781666832,531403007,256694504,972516807,967937919,996713745,582191031,858865897,41970269,522379983,570542149,527006842,663233551,140537020,560163393,418721398,842681357,242241781,151371931,482543622,610863266,718193766,726177694,232610508,123993835,332624947,111975636,573579546,343712007,595142511,177311820,184161398,886807481,527641584,449071295,118850598,503008804,960104068,422702123,611689548,956592976,788202441,232531087,132147424,414136475,71107188,165429014,158272766,819222951,313841927,35674668,434611667,761608962,176174379,521960686,903247907,61750342,77730689,997039698,428277394,441085470,15171534,240167527,103375800,677874265,609752034,785162572,211610976,919758359,877678289,347834639,232739542,310110777,791133437,46161583,132986492,896762636,722216820,953886788,130022695,292561948,382190915,894180078,656375887,996689016,401785144,823537831,521020527,534410476,220585968,609251809,347628491,395205004,704770597,391529973,195669732,428488388,710696112,475920114,882374395,439451999,738644306,659319359,858692589,893415521,88141916,503668937,143254783,108429636,842397381,182083141,616053241,901479814,296684946,24211898,983770055,144883614,671390289,269991811,432382974,438461764,530087441,334189422,981201345,330111595,931645035,231102630,426980707,898817301,613222058,371258721,138448738,170904966,147059743,460744587,151641645,893552284,871931575,584372822,396269593,39443347,66178447,66837936,60930253,24249447,197552227,311115623,913667227,213121357,186607784,327869664,485749633,648214504,647025617,174602910,419781477,148259975,231603646,745701097,31006028,775772510,772568513,338264271,94932286,735337119,452579020,351671550,7567828,335654251,670765719,837400270,98932585,263548004,512761662,304541062,172205921,548385030,936415442,254789925,903726668,331419785,143681122,251386888,96878905,661413854,299782522,828004998,325627332,134253670,732414027,393263109,276323398,976690346,835490184,6652366,319167454,202815595,954620257,745740084,434368814,200744499,422566524,292811996,786276266,335531340,80209969,385761912,483425547,689838963,459531287,209955748,875036604,703397062,214506813,686256263,373932579,454649515,215773837,794331250,710321999,126988539,657605034,81551576,191017791,188257038,423824919,539714883,343505970,306106363,749570028,616467958,608779819,399166324,523533572,544526541,752243669,803734476,770380704,183622319,944711646,930274056,245015519,759584833,896276002,979688501,719544190,145385269,858154911,928323848,906298114,536757580,262672433,159900893,971785784,385996778,752548040,768579743,3827634,627768236,419963408,935558934,446420957,40082892,791404002,986214543,653013462,883518959,73322558,689762354,932546611,278765874,430584045,567683357,99205075,312911854,123551214,671356834,408699998,774742238,920756985,66830449,550778634,368632341,790064487,527929591,178985202,306062141,566124680,162459538,681909525,100151278,659119550,968905578,630353274,475007263,629439991,974424000,162780392,519684343,15160320,550003918,115384794,885138661,305847215,92508773,955050630,287616110,172741769,976528435,710177368,639777772,46920305,790246397,575165062,315623349,411026287,977892309,327431145,881562421,919636548,348732631,84151280,697019304,247856962,717596130,63321011,57312393,139051995,485257961,617113710,264802907,871484813,939266085,506250820,477181298,609341144,708861494,350447711,476942876,39085755,212456708,533366214,237418581,237622580,805805660,782013388,821608639,467021688,727934115,707921653,982108783,483177159,671706314,333929328,335205529,863209056,961815619,266534691,530849470,907301228,86765046,487386755,981690146,287253030,166080501,405311117,478941284,265054194,299754692,328975423,25290974,851561365,889907404,345977936,305473750,796047417,379075583,31160784,971388223,133867634,866233490,659755183,307560762,428294470,257791085,801539848,691228495,91051754,62689085,308300391,8037474,756711087,236522418,993870249,279773593,908469717,205310341,782717223,839483599,151804801,378134499,935155028,460467826,896223388,949846443,379624396,362686346,975290083,258341685,554673190,848175129,559663980,272081943,280713009,314623116,703839827,288517750,31014633,448475413,183859428,422930766,141964384,400428251,109605725,905407667,850645376,278768047,410391839,991725277,282024679,219719608,295543136,18189489,603797838,551557823,305409162,169658677,635505236,547192438,844616648,431473709,414940267,157819887,855338946,656413939,918784639,435934445,610443259,933929738,32312600,748766722,952191575,785040625,633611733,516417120,536743493,803791424,332300996,548444549,688366201,191600343,874132705,917131947,899262566,475418447,348521103,208154172,379781468,295997055,147103695,653049187,278127694,268638696,398126803,246139569,795201441,605031342,860206690,308801657,797019183,117194839,977897216,855433310,838883059,687230388,951995180,801902800,791661829,857095005,124782984,117949450,768331637,862399777,481139237,669945469,131069783,629531319,731914163,851643759,20573373,354632328,439406009,937821533,321464158,64011779,588826700,864529049,268696351,905282306,97584269,612366145,63017792,30873547,621941335,278839411,410259817,992929175,380951083,925594336,487811950,281081906,941593870,460609258,308116385,586727344,842468252,522158181,846440402,647676419,283232802,859152154,139182927,355491332,767291111,945633433,228572897,650552557,516691677,369957934,513242424,39018987,34063831,223320645,218415463,201202971,374316661,64393239,752539100,950579287,432559134,511650569,541115733,669230002,295555759,987002074,509966197,832583793,952757893,785438587,161015488,978128998,932231688,94373195,598929083,324500110,102154765,80837345,695889039,671724167,371319930,536609802,124343259,179868893,723185977,7187924,912837717,366767995,650604592,678428543,494581752,249834122,311818777,915300471,884281852,715103874,514002323,437050014,4675789,368436023,706986937,69219963,910522255,797120137,101730555,246593290,76170713,232421625,450750628,358917413,469797798,830931537], 582438527) == -1

    print("All tests passed")
